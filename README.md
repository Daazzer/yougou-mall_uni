# 优购商城 uni-app 项目



## 项目介绍

优购商城小程序项目



## 项目技术

- 项目框架：[uni-app](https://uniapp.dcloud.io/)
- 样式预编译：[Sass](https://sass-lang.com/)
- 版本管理：[Git](https://git-scm.com/)
- 字体图标：[iconfont](https://www.iconfont.cn/)



## 项目目录结构

```bash
.
├─components
│  └─goods_detail
├─custom-tab-bar
├─pages
│  ├─cart
│  ├─category
│  ├─collect
│  ├─feedback
│  ├─goods_detail
│  ├─goods_list
│  ├─index
│  ├─login
│  ├─order
│  ├─pay
│  ├─search
│  └─user
├─static
│  ├─fonts
│  └─images
└─utils
    └─api
```



## 项目 API

https://api-hmugo-web.itheima.net/api/public/v1/



## 项目路由

| 名称     | 路径                        |
| -------- | --------------------------- |
| 首页     | `/pages/index/index`        |
| 商品分类 | `/pages/category/index`     |
| 购物车   | `/pages/cart/index`         |
| 个人中心 | `/pages/user/index`         |
| 搜索     | `/pages/search/index`       |
| 商品列表 | `/pages/goods_list/index`   |
| 商品详情 | `/pages/goods_detail/index` |
| 商品收藏 | `/pages/collect/index`      |
| 反馈     | `/pages/feedback/index`     |
| 登录     | `/pages/login/index`        |
| 订单查询 | `/pages/order/index`        |
| 支付     | `/pages/pay/index`          |



## 项目实现

- 全局微信自定义导航栏，用于非 tabbar 索引的页面
- 全局搜索栏组件
- 全局商品项组件，封装成多种状态
- 全局商品计总栏
- 全局 http 请求方法封装，统一错误处理
- 全局封装错误提示到 Vue 根实例原型，将 api 响应的信息不是 `200` 的响应数据提示集中处理
- 全局 api 请求方法封装，并挂载带 Vue 根实例原型
- 将 `uni.getStorageSync()` 与 `uni.setStorageSync()` 方法封装到根 Vue 原型上，实现对象的数据与本地数据同步，并且到处复用
- 公用方法：日期格式化、检测登录状态、DOM 元素矩形尺寸获取、响应错误提示

### 首页

- 下拉刷新
- `<swiper>` 轮播图商品展示
- 搜索栏组件的引用，并且通过滚动监听实现固定定位，目的为了能配合下拉刷新时页面样式统一
- 分类导航
- 推荐商品楼层展示

### 商品分类

- 搜索栏组件引用
- 固定侧边分类导航栏
- 右侧商品子类展示
- `v-if` 判断当前分类索引控制展示商品分类数据中的子类数据

### 商品列表

- 下拉刷新，重置分页效果
- 搜索栏组件引用，并且通过滚动监听实现固定定位，目的为了能配合下拉刷新时页面样式统一分类导航
- 自定义 `tabbar` 组件引用，实现不在 `tabbar` 配置中的路由也能显示 `tabbar`
- 筛选栏，滚动监听筛选栏固定定位，并设置出现过渡效果
- 通过 `onReachBottom` 实现瀑布流分页效果，并且做函数节流，阻止用户过快滚动到底部加载数据
- 商品项组件引用，展示商品信息，并且点击组件时跳转到对应商品详情

### 商品详情

- `<swiper>` 展示商品图片列表，如果商品无图片，隐藏索引点并且显示空图片
- 商品信息展示
- 分享：调用微信分享
- 收藏，将收藏商品部分信息存储到本地并且改变收藏图标状态
- `<rich-text>` 显示商品图文详情，图文详情为空时显示空状态
- 联系客服：调用微信联系客服 Api
- 购物车：跳转到购物车页
- 加入购物车：将当前商品部分数据存储到本地并且改变购物车图标状态，并显示信息提示
- 立即购买：将当前商品部分数据存储到本地后并且跳转到购物车

### 购物车

- 商品项组件的引用，开放出商品组件的选中、数量增减、数量显示、商品信息显示、点击图片跳转、点击商品信息选中商品的功能
- 商品总计栏组件引用：
  - 全选
  - 计算总价，利用 `Array.prototype.reduce` 进行加总
  - 删除按钮，如果没有选中商品则提示用户选中商品，如果没有商品则隐藏删除按钮
  - 结算，如果没有选中到商品则禁用结算按钮

### 支付

- 地址栏，如果本地存储没有地址信息则显示未选地址状态，如果本地存储有地址信息数据，则直接填充地址栏
- 商品组件引用，开放商品图片展示、商品信息展示、商品数量显示功能
- 商品总计栏组件引用：
  - 计算总价，利用 `Array.prototype.reduce` 进行加总
  - 支付按钮
- 商品支付
  - 登录状态判断，如果未登录，则提示用户登录
  - 以下操作都是在登录成功的前提条件下才能进行
  - 请求后端服务获取订单号码
  - 通过订单号码再次请求后端服务获取支付参数
  - 通过支付参数调用微信 API 生成付款码进行支付
  - 如果中断支付，则提示用户并且跳转到订单页切换成未付款选项
  - 如果支付成功，则提示用户并且跳转到订单页切换成未发货选项

### 个人中心

- 用户头像信息栏
  - 如果未登录则显示去登录的按钮
  - 如果登录成功，则显示用户头像与用于昵称
- 订单操作栏
  - 如果未登录，则点击一下选项会跳转到登录页
  - 点击待付款跳转到订单页并且切换成待付款选项
  - 点击全部订单则跳转订单页
  - 点击收藏，跳转到商品收藏页

